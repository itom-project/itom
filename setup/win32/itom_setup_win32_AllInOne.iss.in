; Script generated by the Inno Setup Script Wizard.
; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES!

; Ggf. zu ändern!
#define SourceDirSys32 "C:\Windows\System32"
#define SourceDirItomSource "${CMAKE_CURRENT_SOURCE_DIR}"
#define SourceDirItomBuild "${CMAKE_CURRENT_BINARY_DIR}"
#define SourceDirQT "${QT_BINARY_DIR}"
#define SourceDirOpenCV "${OpenCV_BIN_DIR}"
#define SourceRedistributable2010 "W:\m\ITOM\Installationen\1. MS VisualStudio 2010 Pro"
#define SourceRedistributable2015 "W:\m\ITOM\Installationen\5. Python 3.5\32bit"
#define SourceDirPython "W:\m\ITOM\Installationen\5. Python 3.5\32bit"
#define SourceDirPCL "${PCL_DIR}\.."
#define ExeName "Qitom.exe"
#define Name "itom"
#define Version "${ITOM_versionString}"
#define Publisher "ITO Uni Stuttgart"
#define URL "http://www.ito.uni-stuttgart.de/"
#define DSetupMode 32;

[Setup]
; NOTE: The value of AppId uniquely identifies this application.
; Do not use the same AppId value in installers for other applications.
; (To generate a new GUID, click Tools | Generate GUID inside the IDE.)
AppId={{049B12B4-806D-43A2-9616-54FF0F889B30}
AppName={#Name}
AppVersion={#Version}
AppVerName={#Name} {#Version}
AppPublisher={#Publisher}
AppPublisherURL={#URL}
AppSupportURL={#URL}
AppUpdatesURL={#URL}
DefaultDirName={pf}\{#Name}
DefaultGroupName={#Name}
OutputBaseFilename=setup
Compression=lzma
SolidCompression=yes
LicenseFile={#SourceDirItomSource}\COPYING.txt
AlwaysRestart=True

[Dirs]
Name: "{app}\"; Permissions: everyone-modify
Name: "{app}\plugins"; Permissions: everyone-modify
Name: "{app}\designer"; Permissions: everyone-modify
Name: "{app}\designer\translation"; Permissions: everyone-modify
Name: "{app}\demo"; Permissions: everyone-modify
Name: "{app}\itomSettings"; Permissions: everyone-modify
Name: "{app}\lib"; Permissions: everyone-modify
Name: "{app}\help"; Permissions: everyone-modify
; Name: "{app}\sqldrivers"; Permissions: everyone-modify
Name: "{app}\imageformats"; Permissions: everyone-modify
Name: "{app}\translation"; Permissions: everyone-modify
Name: "{app}\itom-packages"; Permissions: everyone-modify
Name: "{app}\SDK"; Permissions: everyone-modify

[Files]
; EXEs
Source: "{#SourceRedistributable2010}\vcredist_x86.exe"; DestDir: "{tmp}"
Source: "{#SourceRedistributable2015}\Redistributable Visual Studio 2015 x86.exe"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\python-3.5.1.exe"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\pip-8.0.3-py2.py3-none-any.whl"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\numpy-1.10.4+mkl-cp35-none-win32.whl"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\scipy-0.17.0-cp35-none-win32.whl"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\six-1.10.0-py2.py3-none-any.whl"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\pyparsing-2.1.0-py2.py3-none-any.whl"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\python_dateutil-2.4.2-py2.py3-none-any.whl"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\pytz-2015.7-py2.py3-none-any.whl"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\matplotlib-1.5.1-cp35-none-win32.whl"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\pies-2.6.7.tar.gz"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\frosted-1.4.1-py2.py3-none-any.whl"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\cycler-0.9.0-py2.py3-none-any.whl"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\scikit_image-0.11.3-cp35-none-win32.whl"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\decorator-4.0.8-py2.py3-none-any.whl"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\networkx-1.11-py2.py3-none-any.whl"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\Pillow-3.1.1-cp35-none-win32.whl"; DestDir: "{tmp}"

#include "itom_setup_win32_common_files.iss"

[Run]
Filename: "{tmp}\vcredist_x86.exe"; Flags: shellexec waituntilterminated; StatusMsg: "Microsoft Visual C++ 2010 Redistributable Package (x86)..."; Components: CREDPACK2010;
Filename: "{tmp}\Redistributable Visual Studio 2015 x86.exe"; Flags: shellexec waituntilterminated; StatusMsg: "Microsoft Visual C++ 2015 Redistributable Package (x86)..."; Components: CREDPACK2015;
Filename: "{tmp}\python-3.5.1.exe"; Parameters: "TargetDir={%SystemDrive}\Python35 PrependPath=1 CompileAll=0"; Flags: shellexec waituntilterminated; StatusMsg: "Phyton 3.5..."; Components: PYTHON; BeforeInstall: PythonBeforeInstall
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --upgrade --only-binary=:all: --no-index {tmp}\pip-8.0.3-py2.py3-none-any.whl"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "Pip..."; Components: PYTHON
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\numpy-1.10.4+mkl-cp35-none-win32.whl"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "NumPy..."; Components: NUMPY
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\scipy-0.17.0-cp35-none-win32.whl"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "SciPy..."; Components: SCIPY
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\six-1.10.0-py2.py3-none-any.whl"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "Six..."; Components: MATPLOTLIB
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\pyparsing-2.1.0-py2.py3-none-any.whl"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "PyParsing..."; Components: MATPLOTLIB
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\python_dateutil-2.4.2-py2.py3-none-any.whl"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "DateUtil..."; Components: MATPLOTLIB
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\pytz-2015.7-py2.py3-none-any.whl"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "PyTz..."; Components: MATPLOTLIB
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\cycler-0.9.0-py2.py3-none-any.whl"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "Cycler..."; Components: MATPLOTLIB
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\matplotlib-1.5.1-cp35-none-win32.whl"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "MatPlotLib..."; Components: MATPLOTLIB
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\six-1.10.0-py2.py3-none-any.whl"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "Six..."; Components: SCIKIT
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\decorator-4.0.8-py2.py3-none-any.whl"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "Decorator..."; Components: SCIKIT
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\networkx-1.11-py2.py3-none-any.whl"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "Networkx..."; Components: SCIKIT
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\Pillow-3.1.1-cp35-none-win32.whl"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "Pillow..."; Components: SCIKIT
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\scikit_image-0.11.3-cp35-none-win32.whl"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "Scikit..."; Components: SCIKIT
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\pies-2.6.7.tar.gz"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "Pies..."; Components: FROSTED
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\frosted-1.4.1-py2.py3-none-any.whl"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "Frosted..."; Components: FROSTED
Filename: "{app}\{#ExeName}"; Flags: nowait postinstall skipifsilent; Description: "{cm:LaunchProgram,{#StringChange(Name, "&", "&&")}}"; Components: Main

[InstallDelete]
Type: files; Name: "{tmp}\vcredist_x86.exe"
Type: files; Name: "{tmp}\Redistributable Visual Studio 2015 x86.exe"
Type: files; Name: "{tmp}\python-3.5.1.exe"
Type: files; Name: "{tmp}\pip-8.0.3-py2.py3-none-any.whl"
Type: files; Name: "{tmp}\numpy-1.10.4+mkl-cp35-none-win32.whl"
Type: files; Name: "{tmp}\scipy-0.17.0-cp35-none-win32.whl"
Type: files; Name: "{tmp}\six-1.10.0-py2.py3-none-any.whl"
Type: files; Name: "{tmp}\pyparsing-2.1.0-py2.py3-none-any.whl"
Type: files; Name: "{tmp}\python_dateutil-2.4.2-py2.py3-none-any.whl"
Type: files; Name: "{tmp}\pytz-2015.7-py2.py3-none-any.whl"
Type: files; Name: "{tmp}\matplotlib-1.5.1-cp35-none-win32.whl"
Type: files; Name: "{tmp}\pies-2.6.7.tar.gz"
Type: files; Name: "{tmp}\frosted-1.4.1-py2.py3-none-any.whl"
Type: files; Name: "{tmp}\cycler-0.9.0-py2.py3-none-any.whl"
Type: files; Name: "{tmp}\scikit_image-0.11.3-cp35-none-win32.whl"
Type: files; Name: "{tmp}\decorator-4.0.8-py2.py3-none-any.whl"
Type: files; Name: "{tmp}\Pillow-3.1.1-cp35-none-win32.whl"
Type: files; Name: "{tmp}\networkx-1.11-py2.py3-none-any.whl"
Type: filesandordirs; Name: "{tmp}\wheelhouse"

[Types]
Name: "Install"; Description: "Installation"; Flags: iscustom

[Components]
Name: "Main"; Description: "{#Name}"; Types: Install; Flags: checkablealone fixed
Name: "CREDPACK2010"; Description: "Microsoft Visual C++ 2010 Redistributable Package (x86)"; Types: Install; Flags: checkablealone fixed; Check: NeedInstallRP10({#DSetupMode})
Name: "CREDPACK2015"; Description: "Microsoft Visual C++ 2015 Redistributable Package (x86)"; Types: Install; Flags: checkablealone fixed; Check: NeedInstallRP15({#DSetupMode})
Name: "PYTHON"; Description: "Python 3.5.1"; Types: Install; Flags: checkablealone
Name: "NUMPY"; Description: "NumPy 1.10.4"; Types: Install; Flags: checkablealone
Name: "SCIPY"; Description: "SciPy 0.17.0"; Types: Install; Flags: checkablealone
Name: "MATPLOTLIB"; Description: "Matplotlib 1.5.1"; Types: Install; Flags: checkablealone
Name: "SCIKIT"; Description: "SciKit Image 0.11.3"; Types: Install; Flags: checkablealone
Name: "FROSTED"; Description: "Frosted 1.4.1"; Types: Install; Flags: checkablealone
Name: "SDK"; Description: "itom SDK"; Types: Install; Flags: checkablealone

[UninstallDelete]
Type: filesandordirs; Name: "{app}\{#ExeName}"

#include "itom_setup_win32_code.iss"
