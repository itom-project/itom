; Script generated by the Inno Setup Script Wizard.
; SEE THE DOCUMENTATION FOR DETAILS ON CREATING INNO SETUP SCRIPT FILES!

#define ExeName "Qitom.exe"
#define Name "itom (x64)"
#define Version "${ITOM_versionString}"
#define Publisher "ITO Uni Stuttgart"
#define URL "http://www.ito.uni-stuttgart.de/"
#define DSetupMode 64;
#define SourceDirItomSource "${CMAKE_CURRENT_SOURCE_DIR}"
#define SourceDirItomBuild "${CMAKE_CURRENT_BINARY_DIR}"
#define SourceDirQT "${QT_BINARY_DIR}"
#define SourceDirOpenCV "${OpenCV_BIN_DIR}"
#define SourceDirPCL "${PCL_DIR}\.."

; You should change...
#define SourceDirSys32 "C:\Windows\System32"
;#define SourceRedistributable2010 "W:\m\ITOM\Installationen\1. MS VisualStudio 2010 Pro"
#define SourceRedistributable2013 "W:\m\ITOM\Installationen\1. MS VisualStudio 2013 Pro"
#define SourceRedistributable2015 "W:\m\ITOM\Installationen\5. Python 3.5\64bit"
#define SourceDirPython "W:\m\ITOM\Installationen\5. Python 3.5\64bit\Numpy1.11.1-Basis"

; Python
; - FNPythonXY file name of Python module XY
; - NaPythonXY name of Python module XY
; - VePythonXY version of Python module XY

#define FNPython "python-3.5.1-amd64.exe"
#define NaPython "Python"
#define VePython "3.5.1"

#define FNPythonPip "pip-8.1.2-py2.py3-none-any.whl"
#define NaPythonPip "Pip"
#define VePythonPip "8.1.2"

#define FNPythonNumPy "numpy-1.11.1+mkl-cp35-cp35m-win_amd64.whl"
#define NaPythonNumPy "NumPy"
#define VePythonNumPy "1.11.1"

#define FNPythonSciPy "scipy-0.18.0-cp35-cp35m-win_amd64.whl"
#define NaPythonSciPy "SciPy"
#define VePythonSciPy "0.18.0"

#define FNPythonSix "six-1.10.0-py2.py3-none-any.whl"
#define NaPythonSix "Six"
#define VePythonSix "1.10.0"

#define FNPythonPyPars "pyparsing-2.1.6-py2.py3-none-any.whl"
#define NaPythonPyPars "PyParsing"
#define VePythonPyPars "2.1.6"

#define FNPythonPyDateu "python_dateutil-2.5.3-py2.py3-none-any.whl"
#define NaPythonPyDateu "DateUtil"
#define VePythonPyDateu "2.5.3"

#define FNPythonPyTz "pytz-2016.6-py2.py3-none-any.whl"
#define NaPythonPyTz "PyTz"
#define VePythonPyTz "2016.6"

#define FNPythonMatPlotLib "matplotlib-1.5.2-cp35-cp35m-win_amd64.whl"
#define NaPythonMatPlotLib "MatPlotLib"
#define VePythonMatPlotLib "1.5.2"

#define FNPythonPies "pies-2.6.7.tar.gz"
#define NaPythonPies "Pies"
#define VePythonPies "2.6.7"

#define FNPythonFrosted "frosted-1.4.1-py2.py3-none-any.whl"
#define NaPythonFrosted "Frosted"
#define VePythonFrosted "1.4.1"

#define FNPythonCycler "cycler-0.10.0-py2.py3-none-any.whl"
#define NaPythonCycler "Cycler"
#define VePythonCycler "0.10.0"

#define FNPythonSciKit "scikit_image-0.12.3-cp35-cp35m-win_amd64.whl"
#define NaPythonSciKit "SciKit Image"
#define VePythonSciKit "0.12.3"

#define FNPythonDecor "decorator-4.0.10-py2.py3-none-any.whl"
#define NaPythonDecor "Decorator"
#define VePythonDecor "4.0.10"

#define FNPythonNetWorkX "networkx-1.11-py2.py3-none-any.whl"
#define NaPythonNetWorkX "NetworkX"
#define VePythonNetWorkX "1.11"

#define FNPythonPillow "Pillow-3.3.0-cp35-cp35m-win_amd64.whl"
#define NaPythonPillow "Pillow"
#define VePythonPillow "3.3.0"

#define FNPythonDask "dask-0.11.1-py2.py3-none-any.whl"
#define NaPythonDask "Dask"
#define VePythonDask "0.11.1"

#define FNPythonToolz "toolz-0.8.0-py2.py3-none-any.whl"
#define NaPythonToolz "Toolz"
#define VePythonToolz "0.8.0"

[Setup]
; NOTE: The value of AppId uniquely identifies this application.
; Do not use the same AppId value in installers for other applications.
; (To generate a new GUID, click Tools | Generate GUID inside the IDE.)
AppId={{BC92C903-FB9E-49ED-AF5C-F43F37D3974A}
AppName={#Name}
AppVersion={#Version}
AppVerName={#Name} {#Version}
AppPublisher={#Publisher}
AppPublisherURL={#URL}
AppSupportURL={#URL}
AppUpdatesURL={#URL}
DefaultDirName={pf64}\{#Name}
DefaultGroupName={#Name}
OutputBaseFilename=setup
Compression=lzma
SolidCompression=yes
LicenseFile={#SourceDirItomSource}\COPYING.txt
AlwaysRestart=True

[Dirs]
Name: "{app}\"; Permissions: everyone-modify
Name: "{app}\plugins"; Permissions: everyone-modify
Name: "{app}\designer"; Permissions: everyone-modify
Name: "{app}\designer\translation"; Permissions: everyone-modify
Name: "{app}\demo"; Permissions: everyone-modify
Name: "{app}\itomSettings"; Permissions: everyone-modify
Name: "{app}\lib"; Permissions: everyone-modify
Name: "{app}\help"; Permissions: everyone-modify
; Name: "{app}\sqldrivers"; Permissions: everyone-modify
Name: "{app}\imageformats"; Permissions: everyone-modify
Name: "{app}\translation"; Permissions: everyone-modify
Name: "{app}\itom-packages"; Permissions: everyone-modify
Name: "{app}\SDK"; Permissions: everyone-modify

[Files]
; EXEs
Source: "{#SourceRedistributable2013}\vcredist_x64.exe"; DestDir: "{tmp}"
Source: "{#SourceRedistributable2015}\Redistributable Visual Studio 2015 x64.exe"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPython}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonPip}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonNumPy}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonSciPy}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonSix}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonPyPars}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonPyDateu}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonPyTz}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonMatPlotLib}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonPies}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonFrosted}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonCycler}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonSciKit}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonDecor}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonNetWorkX}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonPillow}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonDask}"; DestDir: "{tmp}"
Source: "{#SourceDirPython}\{#FNPythonToolz}"; DestDir: "{tmp}"

#include "itom_setup_win64_common_files.iss"

[Run]
Filename: "{tmp}\vcredist_x64.exe"; Flags: shellexec waituntilterminated; StatusMsg: "Microsoft Visual C++ 2013 Redistributable Package (x64)..."; Components: CREDPACK2013;
Filename: "{tmp}\Redistributable Visual Studio 2015 x64.exe"; Flags: shellexec waituntilterminated; StatusMsg: "Microsoft Visual C++ 2015 Redistributable Package (x64)..."; Components: CREDPACK2015;
Filename: "{tmp}\{#FNPython}"; Parameters: "TargetDir={%SystemDrive}\Python35 PrependPath=1 CompileAll=0"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPython} {#VePython}..."; Components: PYTHON; BeforeInstall: PythonBeforeInstall
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --upgrade --only-binary=:all: --no-index {tmp}\{#FNPythonPip}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonPip}..."; Components: PYTHON
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonNumPy}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonNumPy}..."; Components: NUMPY
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonSciPy}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonSciPy}..."; Components: SCIPY
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonSix}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonSix}..."; Components: MATPLOTLIB
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonPyPars}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonPyPars}..."; Components: MATPLOTLIB
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonPyDateu}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonPyDateu}..."; Components: MATPLOTLIB
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonPyTz}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonPyTz}..."; Components: MATPLOTLIB
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonCycler}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonCycler}..."; Components: MATPLOTLIB
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonMatPlotLib}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonMatPlotLib}..."; Components: MATPLOTLIB
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonSix}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonSix}..."; Components: SCIKIT
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonDecor}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonDecor}..."; Components: SCIKIT
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonNetWorkX}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonNetWorkX}..."; Components: SCIKIT
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonDask}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonDask}..."; Components: SCIKIT
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonToolz}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonToolz}..."; Components: SCIKIT
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonPillow}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonPillow}..."; Components: SCIKIT
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonSciKit}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonSciKit}..."; Components: SCIKIT
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonPies}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonPies}..."; Components: FROSTED
Filename: "{code:GetPythonPath}\python.exe"; Parameters: "-m pip install --only-binary=:all: --no-index {tmp}\{#FNPythonFrosted}"; WorkingDir: "{tmp}"; Flags: shellexec waituntilterminated; StatusMsg: "{#NaPythonFrosted}..."; Components: FROSTED


Filename: "{app}\{#ExeName}"; Flags: nowait postinstall skipifsilent; Description: "{cm:LaunchProgram,{#StringChange(Name, "&", "&&")}}"; Components: Main

[InstallDelete]
Type: files; Name: "{tmp}\vcredist_x64.exe"
Type: files; Name: "{tmp}\Redistributable Visual Studio 2015 x64.exe"
Type: files; Name: "{tmp}\{#FNPython}"
Type: files; Name: "{tmp}\{#FNPythonPip}"
Type: files; Name: "{tmp}\{#FNPythonNumPy}"
Type: files; Name: "{tmp}\{#FNPythonSciPy}"
Type: files; Name: "{tmp}\{#FNPythonSix}"
Type: files; Name: "{tmp}\{#FNPythonPyPars}"
Type: files; Name: "{tmp}\{#FNPythonPyDateu}"
Type: files; Name: "{tmp}\{#FNPythonPyTz}"
Type: files; Name: "{tmp}\{#FNPythonMatPlotLib}"
Type: files; Name: "{tmp}\{#FNPythonPies}"
Type: files; Name: "{tmp}\{#FNPythonFrosted}"
Type: files; Name: "{tmp}\{#FNPythonCycler}"
Type: files; Name: "{tmp}\{#FNPythonSciKit}"
Type: files; Name: "{tmp}\{#FNPythonDecor}"
Type: files; Name: "{tmp}\{#FNPythonPillow}"
Type: files; Name: "{tmp}\{#FNPythonDask}"
Type: files; Name: "{tmp}\{#FNPythonToolz}"
Type: files; Name: "{tmp}\{#FNPythonNetWorkX}"
Type: filesandordirs; Name: "{tmp}\wheelhouse"

[Types]
Name: "Install"; Description: "Installation"; Flags: iscustom

[Components]
Name: "Main"; Description: "{#Name}"; Types: Install; Flags: checkablealone fixed
Name: "CREDPACK2013"; Description: "Microsoft Visual C++ 2013 Redistributable Package (x64)"; Types: Install; Flags: checkablealone fixed; Check: NeedInstallRP13({#DSetupMode})
Name: "CREDPACK2015"; Description: "Microsoft Visual C++ 2015 Redistributable Package (x64)"; Types: Install; Flags: checkablealone fixed; Check: NeedInstallRP15({#DSetupMode})
Name: "PYTHON"; Description: "{#NaPython} {#VePython}"; Types: Install; Flags: checkablealone
Name: "NUMPY"; Description: "{#NaPythonNumPy} {#VePythonNumPy}"; Types: Install; Flags: checkablealone
Name: "SCIPY"; Description: "{#NaPythonSciPy} {#VePythonSciPy}"; Types: Install; Flags: checkablealone
Name: "MATPLOTLIB"; Description: "{#NaPythonMatPlotLib} {#VePythonMatPlotLib}"; Types: Install; Flags: checkablealone
Name: "SCIKIT"; Description: "{#NaPythonSciKit} {#VePythonSciKit}"; Types: Install; Flags: checkablealone
Name: "FROSTED"; Description: "{#NaPythonFrosted} {#VePythonFrosted}"; Types: Install; Flags: checkablealone
Name: "SDK"; Description: "itom SDK"; Types: Install; Flags: checkablealone

[UninstallDelete]
Type: filesandordirs; Name: "{app}\{#ExeName}"

#include "itom_setup_win64_code.iss"
